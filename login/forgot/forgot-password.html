<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Forgot Password - TubeEarn</title>
<style>
  :root {
    --accent: #00b09b;
    --accent-dark: #028a77;
    --bg: linear-gradient(to right, #00b09b, #96c93d);
  }
  html,body { height:100%; margin:0; padding:0; font-family: Arial, sans-serif; background: var(--bg); }
  body { display:flex; justify-content:center; align-items:flex-start; padding-top:48px; min-height:100vh; }
  .container {
    width: min(720px, 90%);
    max-width:600px;
    background:#fff;
    border-radius:12px;
    padding:32px;
    box-shadow:0 8px 30px rgba(0,0,0,0.15);
    text-align:center;
  }
  h1 { margin:0 0 6px; color: #0f6b5f; }
  p.lead { margin:0 0 18px; color:#444; font-size:16px; }
  input[type="email"] {
    width:100%; padding:14px; border-radius:8px;
    border:1.5px solid #ddd; font-size:16px; margin-bottom:14px;
  }
  .btn {
    width:100%; padding:14px; border-radius:8px; border:none;
    background:var(--accent); color:white; font-size:16px; cursor:pointer;
  }
  .btn[disabled]{ opacity:0.7; cursor:default; }
  .btn:hover:not([disabled]){ background:var(--accent-dark); }
  .msg { margin-top:14px; font-weight:600; min-height:22px; }
  .msg.error { color:#d93025; }
  .msg.success { color:#18833b; }
</style>
</head>
<body>
  <div class="container">
    <h1>Forgot Password?</h1>
    <p class="lead">Enter your registered email address to receive a reset link.</p>

    <form id="forgotForm">
      <input type="email" id="email" placeholder="Enter your registered email" required />
      <button id="sendBtn" class="btn" type="submit">Send Reset Link</button>
    </form>

    <div id="message" class="msg"></div>
  </div>

<script type="module">
import CONFIG from '../../secure/config/configure.js';

const sendBtn = document.getElementById('sendBtn');
const msgEl = document.getElementById('message');
const emailInput = document.getElementById('email');

document.getElementById('forgotForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  msgEl.textContent = '';
  msgEl.className = 'msg';
  const email = emailInput.value.trim();

  if (!email) {
    msgEl.textContent = 'Please enter your registered email';
    msgEl.classList.add('error');
    return;
  }

  sendBtn.disabled = true;
  const prevText = sendBtn.textContent;
  sendBtn.textContent = 'Please wait...';

  try {
    const res = await fetch(`${CONFIG.API_BASE_URL}/forgot-password`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email })
    });

    const data = await res.json().catch(() => ({}));

    if (res.ok) {
      msgEl.textContent = data.message || 'Reset link sent! Check your email.';
      msgEl.classList.add('success');
    } else {
      msgEl.textContent = data.message || 'Failed to send reset link. Please try again.';
      msgEl.classList.add('error');
    }
  } catch (err) {
    msgEl.textContent = 'Network or server error. Please try again later.';
    msgEl.classList.add('error');
  } finally {
    sendBtn.disabled = false;
    sendBtn.textContent = prevText;
  }
});
</script>
</body>
</html>
