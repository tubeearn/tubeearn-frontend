<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forgot Password - TubeEarn</title>
<style>
    body { font-family: Arial; background: linear-gradient(to right,#4facfe,#00f2fe); display:flex; justify-content:center; align-items:start; height:100vh; margin:0; padding-top:80px;}
    .card { background:white; padding:30px 40px; border-radius:10px; box-shadow:0 5px 10px rgba(0,0,0,0.2); width:320px; text-align:center; }
    input, button { width:100%; padding:10px; margin-bottom:15px; font-size:14px; border-radius:8px; border:1px solid #ccc; }
    button { background:#4facfe; color:white; border:none; cursor:pointer; }
    button:hover { background:#00c3ff; }
    #msg { font-weight:bold; margin-bottom:15px; min-height:20px;}
</style>
</head>
<body>

<div class="card">
    <div id="msg"></div>
    <h2>Forgot Password</h2>
    <p>Enter your registered email</p>
    <input type="email" id="email" placeholder="Email">
    <button id="sendResetBtn">Send Reset Link</button>
</div>

<script type="module">
// ✅ अपने config का सही path डाल
import { BACKEND_URL } from '../secure/config/configure.js';

const msgBox = document.getElementById('msg');
const emailInput = document.getElementById('email');
const sendBtn = document.getElementById('sendResetBtn');

// सिर्फ टेस्ट के लिए — क्लिक हो रहा है या नहीं
console.log("Forgot password JS loaded ✅");

sendBtn.addEventListener('click', async () => {
    console.log("Button clicked ✅");

    const email = emailInput.value.trim();

    if (!email) {
        msgBox.style.color = 'red';
        msgBox.textContent = "⚠ Please enter your registered email.";
        console.log("Email empty ❌");
        return;
    }

    msgBox.style.color = '#555';
    msgBox.textContent = "⏳ Sending...";
    console.log("Sending request to backend:", BACKEND_URL + '/forgot-password');

    try {
        const res = await fetch(`${BACKEND_URL}/forgot-password`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
        });

        console.log("Response status:", res.status);
        const data = await res.json();
        console.log("Response data:", data);

        if (res.ok) {
            msgBox.style.color = 'green';
            msgBox.textContent = "✅ Reset password link has been sent. Please check your email.";
        } else {
            msgBox.style.color = 'red';
            msgBox.textContent = data.message || "❌ Email is not registered.";
        }
    } catch (err) {
        console.error("Fetch error:", err);
        msgBox.style.color = 'red';
        msgBox.textContent = "❌ Server error. Please try again.";
    }
});
</script>

</body>
</html>
