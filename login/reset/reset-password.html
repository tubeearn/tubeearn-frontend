<script type="module">
import { BACKEND_URL } from '../../secure/config/configure.js';

document.getElementById('resetBtn').addEventListener('click', async () => {
    const password = document.getElementById('newPassword').value.trim();
    const msgBox = document.getElementById('msg');

    if (!password) {
        msgBox.innerText = "Please enter a new password.";
        return;
    }

    msgBox.innerText = "Updating password...";

    try {
        const res = await fetch(`${BACKEND_URL}/update-password`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ password })
        });
        const data = await res.json();
        msgBox.innerText = data.message;
        
        if (res.ok) {
            setTimeout(() => {
                window.location.href = "../../login/login.html"; 
            }, 2000);
        }
    } catch (err) {
        msgBox.innerText = "Server error. Please try again.";
    }
});
</script>
